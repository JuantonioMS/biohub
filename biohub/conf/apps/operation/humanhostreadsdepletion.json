{

    "info" : {
        "type" : "conda",
        "environment": "biohub.humanhostreadsdepletion"
    },

    "build": [
        "mamba create -y -p ->eval##self.environment<- bowtie2",
        "wget https://genome-idx.s3.amazonaws.com/bt/GRCh38_noalt_as.zip",
        "unzip GRCh38_noalt_as.zip",
        "mv GRCh38_noalt_as ->eval##self.environment<-/share/GRCh38_noalt_as"
    ],

    "implementation" : {

        "defaultRoute": "paired illumina",

        "commands": [
            {
                "route": "common",
                "command": "bowtie2"
            }
        ],

        "sentences": {

            "body" : [
                {
                    "route" : "common",
                    "sentences" : ["<command> <options> <inputs> > ->eval##self.temporalDirectory<-/reads.sam"]
                }
            ]

        }
    },

    "options": [

        {
            "route" : "common",
            "role" : "bowtie2 index",
            "name" : "-x",
            "value" : "->eval##self.environment<-/share/GRCh38_noalt_as"
        },

        {
            "route": "common",
            "role": "threads",
            "name": "--threads",
            "altName": "-p"
        },

        {
            "route": "paired illumina",
            "role": "unaligned reads",
            "name": "--un-conc-gz",
            "value": "unaligned"
        },

        {
            "route": "paired illumina",
            "role": "aligned reads",
            "name": "--al-conc-gz",
            "value": "aligned"
        }

    ],



    "inputs": [

        {
            "route" : "paired illumina",
            "role" : "forward",
            "name" : "-1",
            "selection" :
            [
                {
                    "target": "outlines",
                    "required": ["reads", "forward", "illumina"],
                    "optimal": ["trimmed"]
                }
            ]
        },

        {
            "route" : "paired illumina",
            "role" : "reverse",
            "name" : "-2",
            "selection" :
            [
                {
                    "target": "outlines",
                    "required": ["reads", "reverse", "illumina"],
                    "optimal": ["trimmed"]
                }
            ]
        }

    ],


    "outputs" :
    [
        {
            "route": "paired illumina",
            "role": "forward",
            "temporal": "unaligned.1",
            "extension": ".fastq.gz",
            "outlines": ["forward", "no host"]
        },

        {
            "route": "paired illumina",
            "role": "reverse",
            "temporal": "unaligned.2",
            "extension": ".fastq.gz",
            "outlines": ["reverse", "no host"]
        },

        {
            "route": "paired illumina",
            "role": "forward",
            "temporal": "aligned.1",
            "extension": ".fastq.gz",
            "outlines": ["forward", "host"]
        },

        {
            "route": "paired illumina",
            "role": "reverse",
            "temporal": "aligned.2",
            "extension": ".fastq.gz",
            "outlines": ["reverse", "host"]
        }
    ],

    "outlines": [
        {
            "route": "common",
            "output": ["reads", "illumina"],
            "process": ["reads", "host depletion"]
        }
    ]

}