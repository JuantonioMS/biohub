{
    "info" : {
        "type" : "anaconda",
        "environment": "biohub.bowtie2"
    },

    "build": [
        "mamba create -y -p ->eval##self.environment<- bowtie2",
        "wget https://ftp.ncbi.nlm.nih.gov/refseq/H_sapiens/annotation/GRCh38_latest/refseq_identifiers/GRCh38_latest_genomic.fna.gz",
        "gzip -d GRCh38_latest_genomic.fna",
        "mv GRCh38_latest_genomic.fna ->eval##self.environment<-/human_genome.fasta",
        ". ->eval##self.condaShell<- && conda activate ->eval##self.environment<- && bowtie2-build ->eval##self.environment<-/human_genome.fasta ->eval##self.environment<-/human_index"
    ],

    "implementation" : {

        "defaultRoute": "paired illumina",

        "commands": [
            {
                "route": "common",
                "command": "bowtie2"
            }
        ],

        "sentences": {

            "body" : [
                {
                    "route" : "common",
                    "sentences" : ["<command> <inputs> <options> > ->eval##self.id<-.sam",
                                   "rm ->eval##self.id<-.sam"]
                }
            ]

        }
    },

    "options": [
        {
            "route": "common",
            "role": "threads",
            "name": "--threads",
            "alternativeName": "-p"
        },
        {
            "route": "common",
            "role": "non matched reads path",
            "name": "--un-conc-gz",
            "value": "->eval##self.temporalDirectory<-/no_host_reads"
        },
        {
            "route": "common",
            "role": "bowtie index",
            "name": "-x",
            "value": "->eval##self.environment<-/human_index"
        }
    ],

    "inputs": [
        {
            "route": "paired illumina",
            "role": "forward",
            "name": "-1",
            "selection": [
                {
                    "target": "outlines",
                    "required": ["reads", "forward", "illumina"],
                    "optimal": ["trimmed"]
                }
            ]
        },
        {
            "route": "paired illumina",
            "role": "reverse",
            "name": "-2",
            "selection": [
                {
                    "target": "outlines",
                    "required": ["reads", "reverse", "illumina"],
                    "optimal": ["trimmed"]
                }
            ]
        }
    ],

    "outputs": [
        {
            "route": "paired illumina",
            "role": "forward",
            "temporal": "no_host_reads.1",
            "extension": ".fastq.gz",
            "outlines": ["reads", "illumina", "trimmed",
                         "no host", "short", "paired", "forward"]
        },
        {
            "route": "paired illumina",
            "role": "reverse",
            "temporal": "no_host_reads.2",
            "extension": ".fastq.gz",
            "outlines": ["reads", "illumina", "trimmed",
                         "no host", "short", "paired", "reverse"]
        }
    ]
}