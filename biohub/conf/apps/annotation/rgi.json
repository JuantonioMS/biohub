{
    "info" : {
        "type" : "conda",
        "environment": "biohub.rgi"
    },

    "build": [
        "mamba create -y -p ->eval##self.environment<- rgi=5.2.0",
        "wget https://card.mcmaster.ca/latest/data",
        "tar -xvf data ./card.json",
        ". ->eval##self.condaShell<- && conda activate ->eval##self.environment<- && rgi load --card_json card.json --local",
        "rm card.json",
        "rm data",
        "mv localDB ->eval##self.environment<-/localDB"
    ],

    "implementation" : {

        "defaultRoute": "common",

        "commands": [
            {
                "route": "common",
                "command": "rgi main"
            }
        ],

        "sentences": {

            "head" : [
                {
                    "route" : "common",
                    "sentences" : ["ln -s ->eval##self.environment<-/localDB localDB"]
                }
            ],

            "body" : [
                {
                    "route" : "common",
                    "sentences" : ["<command> <options> <inputs>"]
                }
            ],

            "tail" : [
                {
                    "route" : "common",
                    "sentences" : ["rm localDB"]
                }
            ]

        }

    },

    "options": [

        {
            "route": "common",
            "role": "outputDirectory",
            "name": "--output_file",
            "altName": "-o",
            "value": "->eval##self.temporalDirectory<-/output"
        },

        {
            "route": "common",
            "role": "threads",
            "name": "--num_threads",
            "altName": "-n"
        },

        {
            "route": "common",
            "role": "clean temporal files",
            "name": "--clean",
            "value": true
        }

    ],

    "inputs": [
        {
            "route": "common",
            "role": "genome",
            "name": "--input_sequence",
            "altName": "-i",
            "selection": [
                {
                    "target": "outlines",
                    "required": ["genome"]
                }
            ]
        }
    ],

    "outputs": [
        {
            "route": "common",
            "role": "json format",
            "temporal": "output.json",
            "extension": ".json",
            "outlines": ["card", "json"]
        },

        {
            "route": "common",
            "role": "txt format",
            "temporal": "output.txt",
            "extension": ".txt",
            "outlines": ["card", "txt"]
        }
    ],

    "outlines": [
        {
            "route": "common",
            "output": ["resistance genes"],
            "process": ["resistance genes"]
        }
    ]
}