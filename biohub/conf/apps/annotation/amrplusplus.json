{



    "info" :
    {
        "type" : "system",
        "environment" : "biohub.amrplusplus"
    },



    "build" :
    [
        "git clone https://github.com/Microbial-Ecology-Group/AMRplusplus.git",
        "mv AMRplusplus ->eval##self.environment<-",
        "singularity pull docker://enriquedoster/amrplusplus:latest",
        "mv amrplusplus_latest.sif ->eval##self.environment<-/amrplusplus.sif"
    ],



    "implementation" :
    {

        "defaultRoute" : "paired illumina",

        "commands" :
        [
            {
                "route" : "common",
                "command" : "singularity exec"
            }
        ],

        "sentences" :
        {

            "body" :
            [
                {
                    "route" : "paired illumina",
                    "sentences" :
                    [
                        "ln -s ->eval##inputs['forward'].path<- ->eval##self.id<-_R1.fastq.gz",
                        "ln -s ->eval##inputs['reverse'].path<- ->eval##self.id<-_R2.fastq.gz",
                        "mkdir ->eval##self.id<-_tmp",
                        "<command> ->eval##self.environment<-/amrplusplus.sif nextflow run ->eval##self.environment<-/main_AMR++.nf --pipeline resistome --reads \"->eval##self.id<-_R{1,2}.fastq.gz\" --output \"->eval##self.temporalDirectory<-/\" -w ->eval##self.id<-_tmp <options>",
                        "rm ->eval##self.id<-_R1.fastq.gz",
                        "rm ->eval##self.id<-_R2.fastq.gz",
                        "rm -rf ->eval##self.id<-_tmp"
                    ]
                }
            ],

            "tail" :
            [
                {
                    "route" : "common",
                    "sentences" :
                    [
                        "rm -rf .nextflow",
                        "rm .nextflow.*"
                    ]
                }
            ]

        }

    },



    "options" :
    [

        {
            "route": "common",
            "role": "threads",
            "name": "--threads"
        }

    ],



    "inputs" :
    [

        {
            "route": "paired illumina",
            "role": "forward",
            "selection": [
                {
                    "target": "outlines",
                    "required": ["reads", "forward", "illumina"],
                    "optimal": ["trimmed"]
                }
            ]
        },

        {
            "route": "paired illumina",
            "role": "reverse",
            "selection": [
                {
                    "target": "outlines",
                    "required": ["reads", "reverse", "illumina"],
                    "optimal": ["trimmed"]
                }
            ]
        }

    ],



    "outputs" :
    [
        {
            "route": "common",
            "role": "genes table",
            "temporal": "Results/AMR_analytic_matrix.csv",
            "extension": ".csv"
        }
    ],



    "outlines":
    [
        {
            "route": "common",
            "output": ["resistance genes"],
            "process": ["resistance genes"]
        }
    ]
}